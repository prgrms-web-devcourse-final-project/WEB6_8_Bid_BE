# K6 ë¶€í•˜ í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

## ğŸ“ ê°œìš”
ì´ ë””ë ‰í† ë¦¬ëŠ” ê²½ë§¤ ì‹œìŠ¤í…œì˜ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ K6 ìŠ¤í¬ë¦½íŠ¸ë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.

## ğŸ¯ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸

### 1. bid-concurrent-test.js
**1000ëª… ë™ì‹œ ì…ì°° ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**
- ë¶„ì‚°ë½ ë™ì‘ ê²€ì¦
- ë°ì´í„° ì •í•©ì„± í™•ì¸
- ë™ì‹œì„± ì²˜ë¦¬ ëŠ¥ë ¥ ì¸¡ì •

### 2. getProducts-test.js
**ìƒí’ˆ ì¡°íšŒ API ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**
- ë‹¤ì–‘í•œ ê²€ìƒ‰ ì‹œë‚˜ë¦¬ì˜¤
- í˜ì´ì§• ì„±ëŠ¥ ì¸¡ì •

### 3. getProductsByElasticsearch-test.js
**Elasticsearch ê¸°ë°˜ ìƒí’ˆ ê²€ìƒ‰ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**
- ì „ë¬¸ ê²€ìƒ‰ ì„±ëŠ¥
- ë³µí•© ì¿¼ë¦¬ ì²˜ë¦¬ ëŠ¥ë ¥

## ğŸš€ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë°©ë²•

### ì‚¬ì „ ì¤€ë¹„
1. Dockerì™€ Docker Compose ì„¤ì¹˜ í™•ì¸
2. ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸ (ê¸°ë³¸: localhost:8080)
3. í…ŒìŠ¤íŠ¸ìš© ë°ì´í„° ì¤€ë¹„ (ìƒí’ˆ, ì‚¬ìš©ì ë“±)

### 1000ëª… ë™ì‹œ ì…ì°° í…ŒìŠ¤íŠ¸ ì‹¤í–‰

#### ê¸°ë³¸ ì‹¤í–‰
```bash
# Docker Composeë¥¼ ì‚¬ìš©í•œ ì‹¤í–‰
docker-compose run --rm k6 run bid-concurrent-test.js

# ë˜ëŠ” ì§ì ‘ Docker ëª…ë ¹ì–´ ì‚¬ìš©
docker run --rm -v $(pwd):/scripts \
  --add-host host.docker.internal:host-gateway \
  grafana/k6 run /scripts/bid-concurrent-test.js
```

#### í™˜ê²½ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•œ ì‹¤í–‰
```bash
# ìƒí’ˆ ID ì§€ì •
docker-compose run --rm k6 run \
  -e PRODUCT_ID=123 \
  bid-concurrent-test.js

# ê¸°ë³¸ ì…ì°°ê°€ ë³€ê²½
docker-compose run --rm k6 run \
  -e BASE_PRICE=2000000 \
  -e PRICE_INCREMENT=500 \
  bid-concurrent-test.js

# ìƒì„¸ ë¡œê·¸ í™œì„±í™”
docker-compose run --rm k6 run \
  -e DETAILED_LOG=true \
  bid-concurrent-test.js

# ëª¨ë“  ì˜µì…˜ ì¡°í•©
docker-compose run --rm k6 run \
  -e PRODUCT_ID=1 \
  -e BASE_PRICE=1000000 \
  -e PRICE_INCREMENT=100 \
  -e DETAILED_LOG=true \
  -e USE_AUTH=false \
  bid-concurrent-test.js
```

### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ ìˆ˜ì •

#### ë¶€í•˜ íŒ¨í„´ ì¡°ì •
`bid-concurrent-test.js` íŒŒì¼ì˜ `stages` ì„¹ì…˜ì„ ìˆ˜ì •í•˜ì—¬ ë¶€í•˜ íŒ¨í„´ì„ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```javascript
stages: [
    { duration: '10s', target: 100 },   // 10ì´ˆ ë™ì•ˆ 100ëª…ê¹Œì§€
    { duration: '20s', target: 500 },   // 20ì´ˆ ë™ì•ˆ 500ëª…ê¹Œì§€
    { duration: '30s', target: 1000 },  // 30ì´ˆ ë™ì•ˆ 1000ëª…ê¹Œì§€
    { duration: '1m', target: 1000 },   // 1ë¶„ ë™ì•ˆ 1000ëª… ìœ ì§€
    { duration: '30s', target: 0 },     // 30ì´ˆ ë™ì•ˆ ì¢…ë£Œ
]
```

#### ì„±ëŠ¥ ê¸°ì¤€ ë³€ê²½
`thresholds` ì„¹ì…˜ì„ ìˆ˜ì •í•˜ì—¬ í…ŒìŠ¤íŠ¸ í†µê³¼ ê¸°ì¤€ì„ ì¡°ì •:

```javascript
thresholds: {
    'http_req_duration': ['p(95)<3000', 'p(99)<5000'],
    'bid_errors': ['rate<0.1'],
    'http_req_failed': ['rate<0.1'],
}
```

## ğŸ“Š ê²°ê³¼ ë¶„ì„

### ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘ ì½˜ì†”ì—ì„œ ì‹¤ì‹œê°„ìœ¼ë¡œ ì§„í–‰ ìƒí™©ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- VU (Virtual Users): í˜„ì¬ í™œì„± ì‚¬ìš©ì ìˆ˜
- ìš”ì²­/ì´ˆ: ì²˜ë¦¬ëŸ‰
- ì—ëŸ¬ìœ¨: ì‹¤íŒ¨í•œ ìš”ì²­ ë¹„ìœ¨

### ìµœì¢… ê²°ê³¼
í…ŒìŠ¤íŠ¸ ì™„ë£Œ í›„ ë‹¤ìŒ ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤:

#### ì„±ëŠ¥ ì§€í‘œ
- **í‰ê·  ì‘ë‹µì‹œê°„**: ì „ì²´ ìš”ì²­ì˜ í‰ê·  ì²˜ë¦¬ ì‹œê°„
- **P95/P99 ì‘ë‹µì‹œê°„**: ìƒìœ„ 5%, 1%ë¥¼ ì œì™¸í•œ ì‘ë‹µì‹œê°„ (SLA ì§€í‘œ)
- **ìµœëŒ€ ì‘ë‹µì‹œê°„**: ê°€ì¥ ì˜¤ë˜ ê±¸ë¦° ìš”ì²­

#### ì²˜ë¦¬ëŸ‰ ë¶„ì„
- **ì´ ìš”ì²­ ìˆ˜**: í…ŒìŠ¤íŠ¸ ë™ì•ˆ ë°œìƒí•œ ì „ì²´ ìš”ì²­
- **ì„±ê³µ/ì‹¤íŒ¨ ê±´ìˆ˜**: ì…ì°° ì„±ê³µ/ì‹¤íŒ¨ í†µê³„
- **ì—ëŸ¬ìœ¨**: ì „ì²´ ìš”ì²­ ëŒ€ë¹„ ì‹¤íŒ¨ ë¹„ìœ¨

#### ë¶„ì‚°ë½ ë™ì‘ ë¶„ì„
- **ì¤‘ë³µ ì…ì°° ë°©ì§€**: ë™ì¼ ì‚¬ìš©ìì˜ ì¤‘ë³µ ì…ì°° ì°¨ë‹¨ ê²€ì¦
- **ìˆœì°¨ ì²˜ë¦¬ìœ¨**: ì…ì°°ê°€ê°€ ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬ë˜ëŠ” ë¹„ìœ¨
- **ë°ì´í„° ì •í•©ì„±**: ìµœì¢… ìƒí’ˆ ê°€ê²©ê³¼ DB ìƒíƒœ ì¼ì¹˜ ì—¬ë¶€

### ê²°ê³¼ íŒŒì¼
í…ŒìŠ¤íŠ¸ ê²°ê³¼ëŠ” `results/` ë””ë ‰í† ë¦¬ì— JSON í˜•ì‹ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤:
- `bid-concurrent-test-latest.json`: ìµœì‹  í…ŒìŠ¤íŠ¸ ê²°ê³¼
- `bid-concurrent-test-TIMESTAMP.json`: íƒ€ì„ìŠ¤íƒ¬í”„ë³„ ê²°ê³¼

## ğŸ” ë¬¸ì œ í•´ê²°

### ì—°ê²° ì˜¤ë¥˜
```
ERRO[0001] dial tcp: lookup host.docker.internal: no such host
```
**í•´ê²°**: Docker Desktop ì—…ë°ì´íŠ¸ ë˜ëŠ” `--add-host` ì˜µì…˜ í™•ì¸

### ì¸ì¦ ì˜¤ë¥˜
```
âŒ ì…ì°° ì‹¤íŒ¨: 401 Unauthorized
```
**í•´ê²°**: 
1. í…ŒìŠ¤íŠ¸ìš© ì‚¬ìš©ì ë°ì´í„° í™•ì¸
2. `USE_AUTH=false`ë¡œ ì¸ì¦ ë¹„í™œì„±í™”
3. ë¡œê·¸ì¸ API ì—”ë“œí¬ì¸íŠ¸ í™•ì¸

### ìƒí’ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŒ
```
âŒ ìƒí’ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìƒí’ˆ IDë¥¼ í™•ì¸í•˜ì„¸ìš”.
```
**í•´ê²°**:
1. ë°ì´í„°ë² ì´ìŠ¤ì— í…ŒìŠ¤íŠ¸ìš© ìƒí’ˆ ìƒì„±
2. ì˜¬ë°”ë¥¸ PRODUCT_ID í™˜ê²½ë³€ìˆ˜ ì„¤ì •

## ğŸ¯ í…ŒìŠ¤íŠ¸ ëª©í‘œ ë° ê¸°ì¤€

### ì„±ëŠ¥ ëª©í‘œ
- **P95 ì‘ë‹µì‹œê°„**: 3ì´ˆ ë¯¸ë§Œ
- **P99 ì‘ë‹µì‹œê°„**: 5ì´ˆ ë¯¸ë§Œ
- **ì—ëŸ¬ìœ¨**: 10% ë¯¸ë§Œ
- **ë™ì‹œ ì‚¬ìš©ì**: 1000ëª… ì²˜ë¦¬ ê°€ëŠ¥

### ë°ì´í„° ì •í•©ì„±
- ëª¨ë“  ì…ì°°ê°€ëŠ” ê³ ìœ í•´ì•¼ í•¨ (ì¤‘ë³µ ì—†ìŒ)
- ìƒí’ˆ ìµœì¢…ê°€ = DB ìµœê³  ì…ì°°ê°€
- ì…ì°° ìˆœì„œ ë³´ì¥ (ë¶„ì‚°ë½ ë™ì‘ í™•ì¸)

## ğŸ“ˆ ì„±ëŠ¥ ê°œì„  ê°€ì´ë“œ

### ì¸¡ì •ëœ ë³‘ëª© ì§€ì 
1. **DB ì»¤ë„¥ì…˜ í’€**: ë™ì‹œ ìš”ì²­ ì¦ê°€ ì‹œ ì»¤ë„¥ì…˜ ë¶€ì¡±
2. **Redis ë¶„ì‚°ë½**: ë½ ëŒ€ê¸° ì‹œê°„ìœ¼ë¡œ ì¸í•œ ì§€ì—°
3. **Kafka ì²˜ë¦¬ëŸ‰**: Consumer ì²˜ë¦¬ ì†ë„

## ğŸ¤ ê¸°ì—¬í•˜ê¸°
í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ ê°œì„ ì´ë‚˜ ë²„ê·¸ ë°œê²¬ ì‹œ ì´ìŠˆë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.

